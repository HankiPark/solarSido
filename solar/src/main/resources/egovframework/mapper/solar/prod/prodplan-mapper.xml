<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="solar.prod.plan.service.impl.ProdPlanMapper">

<select id="selectPlan" resultType="ProdPlanVO">
	SELECT 
		B.plan_deta_no,
		A.plan_no,
		B.prdt_cd, 
		(SELECT prdt_nm FROM prdt WHERE prdt_cd = B.prdt_cd) prdt_nm,
		B.order_no,
		(SELECT paprd_dt FROM order_tb WHERE order_no = B.order_no) paprd_dt, 
		(SELECT order_qty FROM order_d WHERE order_no = B.order_no AND prdt_cd =B.prdt_cd) order_qty,
		B.plan_qty,
		B.wk_dt,
		B.wk_ord
	FROM plan A,  plan_d B
	WHERE A.plan_no = B.plan_no
	<if test="planStartDt != null and planStartDt != ''">
	AND B.plan_dt <![CDATA[>=]]> TO_DATE(#{planStartDt}, 'yyyy-MM-dd')
	</if>
	<if test="planEndDt != null and planEndDt != ''">
	AND B.plan_dt <![CDATA[<=]]> TO_DATE(#{planEndDt}, 'yyyy-MM-dd')
	</if>
	ORDER BY paprd_dt, order_qty
</select>

</mapper>